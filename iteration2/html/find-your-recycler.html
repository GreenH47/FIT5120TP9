<!DOCTYPE html><!--  This site was created in Webflow. https://www.webflow.com  -->
<!--  Last Published: Tue Sep 12 2023 13:11:10 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="64f5c29a90d50c7c42e6aac0" data-wf-site="64f1bb88ea83ec94b1e823e1">

<head>
    <meta charset="utf-8">
    <title>find your recycler</title>
    <meta content="find your recycler" property="og:title">
    <meta content="find your recycler" property="twitter:title">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="Webflow" name="generator">
    <link rel="shortcut icon" href="images/favicon.png">
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/geolib"></script>
    <link href="css/normalize.css" rel="stylesheet" type="text/css">
    <link href="css/webflow.css" rel="stylesheet" type="text/css">
    <link href="css/yuhans-cool-site-76ff05.webflow.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
    <script
        type="text/javascript">WebFont.load({ google: { families: ["Varela Round:400", "Inconsolata:400,700", "Inter:regular,500,600,700", "Libre Baskerville:regular,italic,700", "Volkhov:regular,italic,700,700italic", "Noto Serif:regular,italic,700,700italic"] } });</script>
    <script
        type="text/javascript">!function (o, c) { var n = c.documentElement, t = " w-mod-"; n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch") }(window, document);</script>


    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map_container {
            display: flex;
            align-items: flex-start;
            margin-left: 100px;
            align-items: flex-start;
            margin: 2em auto;
            /* Centers the map container on the page */
            max-width: 1500px;
            /* You can adjust this as needed */
        }

        #map {
            width: 1500px;
            height: 1400px;
            flex: 3;
            /* Adjust this for a bigger map relative to the marker list */
            border-radius: 8px;
            /* Gives the map slightly rounded corners */
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        }

        #markerList {

            /* Adjust the margin as per your requirement */
            height: 1400px;
            /* Adjust based on your needs */
            width: 500px;
            overflow-y: auto;
            /* Allows scrolling if the list gets too long */
            border-radius: 8px;
            /* Consistency in design */
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            /* Same shadow as the map for depth */
            padding: 1em;
            /* Some padding so text isn't right up against the edge */
            background-color: #f7f7f7;
        }
    </style>
</head>

<body>
    <div data-collapse="small" data-animation="default" data-duration="400" data-easing="ease" data-easing2="ease"
        role="banner" class="nav-bar w-nav">
        <div class="nav-container w-container">
            <div class="logo-div">
                <a href="index.html" class="nav-logo w-inline-block"><img src="images/logo-no-background.png"
                        width="133" sizes="133px"
                        srcset="images/logo-no-background-p-500.png 500w, images/logo-no-background-p-800.png 800w, images/logo-no-background.png 1000w"
                        alt="" class="logo"></a>
            </div>
            <nav role="navigation" class="nav-content w-nav-menu">
                <div class="search-banner">
                    <div class="search-section">
                        <form action="/search" class="search w-form"><input type="submit" value="Search"
                                class="hidden w-button"></form>
                    </div>
                </div>
                <div class="nav-menu">
                    <a href="index.html" class="nav-link w-nav-link">Home</a>
                    <a href="know-your-area.html" aria-current="page" class="nav-link w-nav-link w--current">Know Your Area</a>
                    <a href="sort-your-trash.html" class="nav-link w-nav-link">Sort your Trash</a>
                    <a href="find-your-recycler.html" class="nav-link w-nav-link">Find Your Recycler</a>
                    <a href="resources.html" class="nav-link w-nav-link">DIY Class</a>
                </div>
                <div class="nav-cta-button-container"></div>
            </nav>
            <div class="menu-button w-nav-button"><img src="images/Menu-Icon.svg" loading="lazy" width="24" alt=""
                    class="menu-icon"></div>
        </div>
    </div>
    <div class="div-block-11"></div>
    <section class="section-5">
        <div>
            <div class="columns-9 w-row">
                <div class="w-col w-col-6">
                    <h1 class="heading-23"><strong class="bold-text-12">Find Your Recycler</strong></h1>
                    <p class="paragraph-49">Easily locate your nearest bin with essential information of waste disposal
                        options in your postcode area. Whether your goal is to recycle plastics, dispose of household
                        waste or manage hazardous materials responsibly, we are here to assist you in managing your
                        waste and reduce your environmental impact.</p>
                </div>
                <div class="w-col w-col-6">
                    <div class="w-layout-blockcontainer container-9 w-container"><img src="images/pexels-ready-made-3850512.jpg" loading="lazy" sizes="(max-width: 479px) 300px, (max-width: 767px) 500px, (max-width: 991px) 364px, 100vw" srcset="images/pexels-ready-made-3850512.jpg 500w, images/pexels-ready-made-3850512.jpg 800w, images/pexels-ready-made-3850512.jpg 1080w, images/pexels-ready-made-3850512.jpg 1600w, images/pexels-ready-made-3850512.jpg 2000w, images/pexels-ready-made-3850512.jpg 2600w, images/pexels-ready-made-3850512.jpg 3200w, images/pexels-ready-made-3850512.jpg 6000w" alt="" class="image-19"></div>
                </div>
            </div>
        </div>
        <div class="div-block-12"></div>
        <div>

        </div>

        <input type="text" id="addressInput" placeholder="Enter your address" class="styled-input">
        <select id="filterSelect">
            <option value="">Select Waste Type</option>
        </select>
        <button class="search-button" onclick="searchAddress()">Search</button>


        <div role="list" class="w-dyn-items">

            <div style="height: 50px;"></div>
            <script
                src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.1/mapbox-gl-directions.js"></script>
            <link rel="stylesheet"
                href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.1/mapbox-gl-directions.css"
                type="text/css">
            <div id="map_container">
                <div id="map"></div>
                <div id="markerList"></div>
            </div>

        </div>
    </section>
    <div class="footer">
        <div class="footer-container w-container">
            <div class="w-layout-grid footer-grid">
                <div id="w-node-b8d7be4a-ce45-83ab-5947-02d204c8bff0-cf3fcb86" class="footer-logo-block">
                    <a data-ix="logo" href="index.html" class="footer-logo w-nav-brand"><img
                            src="images/logo-no-background.png" width="204" sizes="(max-width: 479px) 83vw, 204px"
                            srcset="images/logo-no-background-p-500.png 500w, images/logo-no-background-p-800.png 800w, images/logo-no-background.png 1000w"
                            alt=""></a>
                    <p class="paragraph small">Built by <a href="#">Fantastic Nine</a>.<br></p>
                    <div class="spacer _16"></div>
                    <div class="paragraph small">© 2023 Waste Island. All Rights Reserved.</div>
                </div>
                <div class="footer-links-container">
                    <h5 class="footer-header">Website</h5>
                    <a href="index.html" class="footer-link">Home</a>
                    <a href="know-your-area.html" class="footer-link">Know Your Area</a>
                    <a href="sort-your-trash.html" aria-current="page" class="footer-link w--current">Sort Your Trash</a>
                    <a href="find-your-recycler.html" class="footer-link">Find Your Recycler</a>
                    <a href="resources.html" class="footer-link">DIY Class</a>
                </div>
            </div>
        </div>
    </div>
    <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=64f1bb88ea83ec94b1e823e1"
        type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
    <script src="js/webflow.js" type="text/javascript"></script>

    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiZ3JlZW5oIiwiYSI6ImNsOTZ4cXVqaDAzYTAzbnBkOHZrNGhscTYifQ.5CyI_nX9gcLhuYfYpgWC9w';
        navigator.geolocation.getCurrentPosition(success, error);
        //import * as geolib from 'geolib';
        const markers = []; // Array to store all markers
        // Store markers and their waste_type information
        // Store the unique waste_type values in an array
        var uniqueWasteTypes = [];

        // Store the markers and markerList items in separate arrays
        var markerItems = [];


        function fetchData() {
            return fetch('resource/bin.json')
                .then(response => response.json())
                .then(data => data);
        }



        function success(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;

            const map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v12',
                center: [longitude, latitude],
                zoom: 10
            });

            new mapboxgl.Marker({
                color: "red",
                draggable: true
            }).setLngLat([longitude, latitude]).addTo(map);

            map.addControl(
                new MapboxDirections({
                    accessToken: mapboxgl.accessToken
                }),
                'top-left'
            );

            // Read the points from the JSON file
            fetchData()
                .then(data => {


                    const markerList = document.getElementById('markerList');
                    // Clear the existing marker list
                    markerList.innerHTML = '';

                    // Add markers for each point within 10 km of the user's location
                    data.forEach(point => {
                        const distance = geolib.getDistance(
                            { latitude: latitude, longitude: longitude },
                            { latitude: point.latitude, longitude: point.longtitude }
                        );
                        const isWithinRange = distance <= 10000; // 10 km in meters

                        if (isWithinRange) {
                            var marker = new mapboxgl.Marker()
                                .setLngLat([point.longtitude, point.latitude])
                                .addTo(map);

                            //markers.push(marker); // Add marker to the array

                            // Add the marker info to the list as a hyperlink
                            const markerInfo = document.createElement('li');
                            const markerLink = document.createElement('a');
                            markerLink.href = '#';
                            markerLink.textContent = `${point.recycle_centre}- ${point.waste_type}`;

                            // Add waste_type value to uniqueWasteTypes if it doesn't exist
                            if (!uniqueWasteTypes.includes(point.waste_type)) {
                                uniqueWasteTypes.push(point.waste_type);
                            }

                            markerLink.addEventListener('click', () => {
                                markers.forEach(m => {
                                    if (m._element) m._element.style.backgroundColor = 'initial'; 
                                });

                                // Fly to the clicked marker
                                map.flyTo({ center: [point.longtitude, point.latitude], zoom: 15 });
                            });

                            markerInfo.appendChild(markerLink);
                            markerList.appendChild(markerInfo);
                            // Add marker and markerList item to their respective arrays
                            markers.push(marker);
                            markerItems.push(markerInfo);
                        }
                    });

                    generateFilterOptions();

                })
                .catch(error => {
                    console.log(error);
                });
        }


        function error(error) {
            var longitude = 144.9631;
            var latitude = -37.8136;
            console.log(error.message);

            const map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v12',
                center: [longitude, latitude],
                zoom: 13
            });

            new mapboxgl.Marker({
                color: "red",
                draggable: true
            }).setLngLat([longitude, latitude]).addTo(map);

            map.addControl(
                new MapboxDirections({
                    accessToken: mapboxgl.accessToken
                }),
                'top-left'
            );

            // Read the points from the JSON file
            fetchData()
                .then(data => {


                    const markerList = document.getElementById('markerList');
                    // Clear the existing marker list
                    markerList.innerHTML = '';

                    // Add markers for each point within 10 km of the user's location
                    data.forEach(point => {
                        const distance = geolib.getDistance(
                            { latitude: latitude, longitude: longitude },
                            { latitude: point.latitude, longitude: point.longtitude }
                        );
                        const isWithinRange = distance <= 10000; // 10 km in meters

                        if (isWithinRange) {
                            var marker = new mapboxgl.Marker()
                                .setLngLat([point.longtitude, point.latitude])
                                .addTo(map);

                            //markers.push(marker); // Add marker to the array

                            // Add the marker info to the list as a hyperlink
                            const markerInfo = document.createElement('li');
                            const markerLink = document.createElement('a');
                            markerLink.href = '#';
                            markerLink.textContent = `${point.recycle_centre}`;

                            markerLink.addEventListener('click', () => {
                                markers.forEach(m => {
                                    if (m._element) m._element.style.backgroundColor = 'initial'; 
                                });

                                // Fly to the clicked marker
                                map.flyTo({ center: [point.longtitude, point.latitude], zoom: 15 });
                            });

                            markerInfo.appendChild(markerLink);
                            markerList.appendChild(markerInfo);
                        }
                    });

                })
                .catch(error => {
                    console.log(error);
                });


        }


        // user input address box and search
        function searchAddress() {
            const address = document.getElementById('addressInput').value;
            const geocodingUrl = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(
                address
            )}.json?access_token=${mapboxgl.accessToken}`;

            fetch(geocodingUrl)
                .then(response => response.json())
                .then(data => {
                    if (data.features.length > 0) {
                        // Get the coordinates of the first result
                        const [longitude, latitude] = data.features[0].center;

                        const map = new mapboxgl.Map({
                            container: 'map',
                            style: 'mapbox://styles/mapbox/streets-v12',
                            center: [longitude, latitude],
                            zoom: 13
                        });



                        man_success(latitude, longitude)

                    } else {
                        console.log('No results found for the entered address.');
                    }
                })
                .catch(error => {
                    console.log('An error occurred while processing the address:', error);
                });
        }

        // user input address and geneate map markers
        function man_success(latitude, longitude) {


            const map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v12',
                center: [longitude, latitude],
                zoom: 10
            });

            new mapboxgl.Marker({
                color: "red",
                draggable: true
            }).setLngLat([longitude, latitude]).addTo(map);

            map.addControl(
                new MapboxDirections({
                    accessToken: mapboxgl.accessToken
                }),
                'top-left'
            );

            // Read the points from the JSON file
            fetchData()
                .then(data => {


                    const markerList = document.getElementById('markerList');
                    // Clear the existing marker list
                    markerList.innerHTML = '';

                    // Add markers for each point within 10 km of the user's location
                    data.forEach(point => {
                        const distance = geolib.getDistance(
                            { latitude: latitude, longitude: longitude },
                            { latitude: point.latitude, longitude: point.longtitude }
                        );
                        const isWithinRange = distance <= 10000; // 10 km in meters

                        if (isWithinRange) {
                            var marker = new mapboxgl.Marker()
                                .setLngLat([point.longtitude, point.latitude])
                                .addTo(map);

                            //markers.push(marker); // Add marker to the array

                            // Add the marker info to the list as a hyperlink
                            const markerInfo = document.createElement('li');
                            const markerLink = document.createElement('a');
                            markerLink.href = '#';
                            markerLink.textContent = `${point.recycle_centre}- ${point.waste_type}`;

                            // Add waste_type value to uniqueWasteTypes if it doesn't exist
                            if (!uniqueWasteTypes.includes(point.waste_type)) {
                                uniqueWasteTypes.push(point.waste_type);
                            }

                            markerLink.addEventListener('click', () => {
                                markers.forEach(m => {
                                    if (m._element) m._element.style.backgroundColor = 'initial'; 
                                });

                                // Fly to the clicked marker
                                map.flyTo({ center: [point.longtitude, point.latitude], zoom: 15 });
                            });

                            markerInfo.appendChild(markerLink);
                            markerList.appendChild(markerInfo);
                            // Add marker and markerList item to their respective arrays
                            markers.push(marker);
                            markerItems.push(markerInfo);
                        }
                    });

                    generateFilterOptions();

                })
                .catch(error => {
                    console.log(error);
                });


        }



        // clear all markers
        function clearMarkers() {
            // Clear any existing markers on the map
            for (const marker of markers) {
                marker.remove();
            }
            markers = [];
        }

        document.getElementById("filterSelect").addEventListener("change", handleSelectChange);

        function handleSelectChange() {
            var selectedValue = this.value;
            filterMarkerList(selectedValue);
        }

        // Dynamically generate option elements for waste_type filter
        function generateFilterOptions() {
            var selectElement = document.getElementById("filterSelect");

            // 清除已存在的选项，避免重复添加
            while (selectElement.children.length > 1) {
                selectElement.removeChild(selectElement.lastChild);
            }

            uniqueWasteTypes.forEach((wasteType) => {
                var option = document.createElement("option");
                option.value = wasteType;
                option.textContent = wasteType;
                selectElement.appendChild(option);
            });
        }

        // Filter the markerList and markers based on the selected waste_type
        function filterMarkerList(selectedValue) {
            console.log(markerItems);
            console.log(markerItems.length);
            //markers.remove();
            for (var i = 0; i < markerItems.length; i++) {
                var markerLink = markerItems[i].getElementsByTagName("a")[0];
                var wasteType = markerLink.textContent.split("-")[1].trim();

                if (selectedValue === "" || wasteType === selectedValue) {
                    markerItems[i].style.display = "block";
                    //markers[i].addTo(map);
                } else {
                    markerItems[i].style.display = "none";
                    //markers[i].remove();
                }
            }
        }

    </script>


</body>

</html>